<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width-device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta charset="UTF-8">
<title>rocket mining</title>

<style>
/* ========================================================== */
/* ========= YANGILANGAN FUTURISTIK KO'RINISH STILI ========= */
/* ========================================================== */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    /* Asosiy fonni chuqur koinot rangiga o'zgartirish */
    background: #0d0d1e; /* Chuqur ko'k-qora koinot */
    color: #e0f7fa; /* Matn rangini yorqin oq/och ko'k qilish */
    text-align: center;
    padding: 0;
    margin: 0;
    overflow-x: hidden;
    min-height: 100vh;
    position: relative;
    padding-bottom: 70px; 
    background-attachment: fixed; 
}

/* Yulduzlar animatsiyasi uchun stil - Yaxshilangan Starfield */
.star-layer {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 0; 
}

/* Kichik va o'rta yulduzlar (Pastki qatlam) */
.star-layer::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* Yulduzlar yaratish (radial-gradientlarni ko'paytirish va rangini o'zgartirish) */
    background: radial-gradient(1.5px 1.5px at 20% 30%, #fff, rgba(0,0,0,0)),
                radial-gradient(1.5px 1.5px at 90% 40%, #c4e4ff, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 15% 80%, #a4c4f0, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 70% 10%, #fff, rgba(0,0,0,0)),
                radial-gradient(1.5px 1.5px at 50% 50%, #fff, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 10% 70%, #d4eaf9, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 80% 10%, #fff, rgba(0,0,0,0)),
                radial-gradient(1px 1px at 60% 85%, #fff, rgba(0,0,0,0)),
                radial-gradient(1.5px 1.5px at 30% 60%, #c4e4ff, rgba(0,0,0,0));
                
    /* Sekin harakatlanuvchi koinot foni */
    animation: starfield 120s linear infinite;
    background-size: 500px 500px;
}

/* Kattaroq va tezroq harakatlanuvchi yulduzlar (Yuqori qatlam) */
.star-layer::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(2px 2px at 40% 10%, #fffeff, rgba(0,0,0,0)),
                radial-gradient(2.5px 2.5px at 10% 20%, #c5e6ff, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 60% 70%, #fff, rgba(0,0,0,0));

    /* Tezroq harakatlanuvchi koinot foni */
    animation: starfield 60s linear infinite reverse;
    background-size: 600px 600px;
}

@keyframes starfield {
    from { background-position: 0 0; }
    to { background-position: 100% 100%; }
}


/* === Yuqori Panel (Top-Bar) === */
.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 10px 15px;
    box-sizing: border-box;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 10;
    /* Neon effektli, shaffof qora fon */
    background: rgba(13, 13, 30, 0.85); 
    backdrop-filter: blur(8px);
    border-bottom: 2px solid #3a75b7; /* To'q ko'k chegara */
    box-shadow: 0 0 15px rgba(58, 117, 183, 0.5); /* Yengil neon soya */
}

/* YANGI: Online va Server qutilarini o'z ichiga oluvchi konteyner */
.online-server-container {
    display: flex;
    flex-direction: column; /* Ustma-ust joylash */
    gap: 10px; /* Server box va Online box orasidagi bo'shliq */
}

/* --- YANGI QO'SHILGAN ONLAYN HOLAT STILI --- */
.online-box {
    /* Balans qutisini koinot mavzusiga moslashtirish */
    background: #1a237e; /* To'q ko'k fon */
    padding: 10px 15px;
    border-radius: 12px;
    box-shadow: 0 0 10px #4fc3f7, 0 0 20px rgba(79, 195, 247, 0.3); /* Yorqin ko'k soya */
    display: inline-block;
    text-align: left;
    border: 1px solid #4fc3f7;
    order: 1; /* Birinchi turishi uchun */
    margin-right: 0; /* Marginni olib tashlash */
    margin-bottom: 0; /* Server box bilan ajratish */
}

.online-title {
    font-size: 13px;
    color: #bbdefb; /* Oq matnga nisbatan yengil rang */
    text-transform: uppercase;
}

.online-value {
    font-size: 22px;
    font-weight: bold;
    margin-top: 2px;
    color: #ffd700; /* Yorqin Oltin rang */
}

/* --- YANGI QO'SHILGAN SERVER STATUS STILI --- */
.server-status-box {
    /* Online-box stili bilan bir xil, lekin biroz boshqacha rangda */
    background: #311b92; /* To'q binafsha/ko'k fon */
    padding: 10px 15px;
    border-radius: 12px;
    box-shadow: 0 0 10px #7c4dff, 0 0 20px rgba(124, 77, 255, 0.3); /* Binafsha soya */
    display: inline-block;
    text-align: left;
    border: 1px solid #7c4dff;
    order: 2; /* Ikkinchi turishi uchun */
    min-width: 120px; /* Minimal kenglik berish */
}
.server-title {
    font-size: 13px;
    color: #bbdefb; /* Oq matnga nisbatan yengil rang */
    text-transform: uppercase;
}
.server-value {
    font-size: 14px;
    font-weight: bold;
    margin-top: 2px;
    color: #ffcc00; /* Boshlang'ich holat rangi */
}
/* --- SERVER STATUS STILI TUGADI --- */


/* --- YANGILANAYOTGAN BALANCE QUTISINING STILI --- */
.balance-box {
    /* Balans qutisini koinot mavzusiga moslashtirish */
    background: #1a237e; /* To'q ko'k fon */
    padding: 1px 10px;
    border-radius: 12px;
    box-shadow: 0 0 10px #4fc3f7, 0 0 20px rgba(79, 195, 247, 0.3); /* Yorqin ko'k soya */
    display: inline-block;
    text-align: left;
    border: 1px solid #4fc3f7;
    order: 1; /* Birinchi turishi uchun */
    /* Balans va Kunlik Bonus konteyneri */
    display: flex;
    flex-direction: column; 
    align-items: flex-start;
    margin-right: 10px; /* Online/Server konteyneri bilan ajratish */
}

.balance-title {
    font-size: 13px;
    color: #bbdefb; /* Oq matnga nisbatan yengil rang */
    text-transform: uppercase;
}

.balance-value {
    font-size: 22px;
    font-weight: bold;
    margin-top: 2px;
    color: #a7ffeb; /* Neon yashil-ko'k rang */
    margin-bottom: 5px; /* Kunlik bonus bilan ajratish */
}
/* --- KUNLIK BONUS STILI --- */
.daily-bonus-container {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 5px;
}

.daily-bonus-btn {
    padding: 5px 10px;
    background: linear-gradient(45deg, #FFD700, #FFA500); /* Oltin/To'q sariq gradient */
    color: #333;
    border: none;
    border-radius: 6px;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

.daily-bonus-btn:active {
    transform: scale(0.95);
}

.daily-bonus-btn:disabled {
    background: #333;
    color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
}

.timer-text {
    font-size: 12px;
    font-weight: bold;
    color: #ffd700; /* Oltin rang */
}
/* ------------------------- */


.action-buttons {
    display: flex;
    gap: 10px;
    align-items: center;
    order: 3; /* Oxirida turishi uchun */
}

/* Yuqori Panelni markazga joylash uchun flex container qo'shish */
.top-left-container {
    display: flex;
    align-items: flex-start; /* Kunlik bonus bilan moslash uchun yuqoriga tekislash */
    order: 1; /* chap tomonda turishi uchun */
}
/* --- YANGI QO'SHILGAN ONLAYN HOLAT STILI TUGADI --- */


/* === Chat va Yangilash Tugmalari Stili === */
.refresh-btn, .chat-btn {
    transition: all 0.2s ease-in-out;
    border: 2px solid;
}

.refresh-btn {
    background: #4CAF50; 
    border-color: #a5d6a7;
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.7);
}
.refresh-btn:active {
    background: #388e3c;
    transform: scale(0.95) rotate(-30deg);
}

.chat-btn {
    background: #FF5722; 
    border-color: #ffccbc;
    box-shadow: 0 0 8px rgba(255, 87, 34, 0.7);
    width: 45px;
    height: 45px;
    line-height: 45px;
}
.chat-btn span {
    font-size: 22px;
}
.chat-btn:active {
    background: #e64a19;
    transform: scale(0.95);
}

/* === Asosiy Kontent === */
.main-content {
    padding-top: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.rocket-container {
    position: relative;
    height: 250px; 
    margin: 20px auto;
    overflow: hidden; 
    /* Raketa joylashgan maydonning markazini biroz yoritish */
    background: radial-gradient(circle at center, rgba(30, 144, 255, 0.1) 0%, transparent 70%);
    width: 100%;
    max-width: 400px;
}

.rocket-image {
    width: 150px; 
    height: auto;
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    transition: opacity 0.5s;
    z-index: 5;
    /* Yorqinlik berish */
    filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.6)); 
}

/* Bulutlar stili - Ko'rinib turishi uchun rangni moslashtirish */
.cloud {
    position: absolute;
    background: rgba(255, 255, 255, 0.9); /* Yorqin oq */
    border-radius: 50%;
    opacity: 0.8;
    box-shadow: 0 0 15px rgba(135, 206, 250, 0.8); /* Osmon rangidagi soya */
    display: none;
}

/* Raketa animatsiyasi qoldi */
@keyframes launch {
    0% { transform: translate(-50%, 0) rotate(0deg); opacity: 1; }
    25% { transform: translate(-50%, -50px) rotate(1deg); opacity: 1; } 
    75% { transform: translate(-50%, -100px) rotate(-1deg); opacity: 1; }
    100% { transform: translate(-50%, 0) rotate(0deg); }
}

/* === Status Bloklari Stili (Fuel/Shield) === */
.status-container {
    display: flex;
    justify-content: space-around;
    align-items: flex-start;
    width: 100%;
    max-width: 380px;
    margin: 20px auto 0;
    padding: 0 10px;
}

.status-item {
    text-align: center;
    flex-basis: 48%;
    background: rgba(0, 0, 0, 0.5); /* Shaffof qora fon */
    border: 1px solid #4a148c; /* Binafsha chegara */
    border-radius: 10px;
    padding: 15px 10px;
    box-shadow: 0 0 10px rgba(123, 31, 162, 0.5); /* Binafsha neon soya */
}

.status-icon {
    width: 40px;
    height: 40px;
    margin-bottom: 5px;
    display: inline-block;
    filter: drop-shadow(0 0 5px #fff); /* Ikonkalarga yorug'lik berish */
}

.status-value {
    font-weight: bold;
    font-size: 18px;
    color: #ffeb3b; /* Yorqin sariq rang */
    text-shadow: 0 0 5px #ffeb3b;
    margin-top: 5px;
    margin-bottom: 10px;
    display: block; /* To'liq qatorni egallashi uchun */
}

.refill-btn {
    padding: 10px 18px;
    margin-top: 10px;
    background: linear-gradient(135deg, #FF5722, #f44336); /* To'q sariq gradient */
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(255, 87, 34, 0.5);
    font-weight: bold;
    text-transform: uppercase;
}

.refill-btn:active {
    box-shadow: 0 2px 5px rgba(0,0,0,0.4);
    transform: translateY(2px);
}
    
/* Qalqon va Yoqilg'i tugmalari 100% bo'lganda ko'rinmasligi uchun */
.refill-btn.hidden {
    display: none;
}
    
/* === Launch Tugmasi Stili (Main-Btn) === */
.main-btn {
    margin-top: 30px;
    padding: 16px 32px;
    /* Kuchli neon ko'k gradient */
    background: linear-gradient(90deg, #007bff, #00d2ff);
    color: white;
    border: none;
    border-radius: 15px;
    font-size: 18px;
    font-weight: bold;
    /* Kuchliroq soya va pulsatsiya effekti uchun */
    box-shadow: 0 0 20px rgba(0, 210, 255, 0.8), 0 0 5px rgba(0, 123, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
}
.main-btn:hover {
    background: linear-gradient(90deg, #00d2ff, #007bff);
    transform: translateY(-2px);
}
.main-btn:active {
    transform: translateY(0);
    box-shadow: 0 0 10px rgba(0, 210, 255, 0.5);
}


/* === PASTKI NAVIGATSIYA STILI === */
.bottom-nav {
    display: flex;
    justify-content: space-around;
    align-items: center;
    width: 100%;
    position: fixed;
    bottom: 0;
    left: 0;
    /* Futuristik, shaffof fon */
    background: rgba(13, 13, 30, 0.95); 
    box-shadow: 0 -5px 20px rgba(58, 117, 183, 0.4);
    padding: 8px 0;
    box-sizing: border-box;
    z-index: 20;
    border-top: 2px solid #3a75b7;
}

.bottom-nav button {
    flex-grow: 1;
    padding: 10px 5px;
    border: none;
    border-radius: 8px;
    font-size: 11px; 
    font-weight: bold;
    transition: transform 0.2s, box-shadow 0.2s;
    margin: 0 3px;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

.bottom-nav button:active {
    transform: scale(0.95);
    box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
}
    
/* Pastki navigatsiya tugmalari ranglari - Neon ranglar ishlatildi */
.withdraw-btn { 
    background: linear-gradient(45deg, #00c16e, #00ff8e); 
    color: #111; 
}
.tasks-btn { 
    background: linear-gradient(45deg, #ffaa00, #ffeb3b); 
    color: #111; 
}
.referral-btn { 
    background: linear-gradient(45deg, #8A2BE2, #b39ddb); 
    color: white; 
}
.leaderboard-btn { 
    background: linear-gradient(45deg, #FFD700, #ffff8d); 
    color: #333; 
}
.games-btn { 
    background: linear-gradient(45deg, #FF5722, #ff8a65); 
    color: white; 
}

</style>

</head>
<body>

<div class="top-bar">
    <div class="top-left-container">
        <div class="online-server-container">
            <div class="online-box">
                <div class="online-title">Online</div>
                <div class="online-value" id="online-users">0</div>
            </div>
            
            <div class="server-status-box" id="server-status-box">
                <div class="server-title" id="server-title">Server Status</div>
                <div class="server-value" id="server-status">Connecting...</div>
            </div>
        </div>
        
        <div class="balance-box">
            <div class="balance-title">Balance</div>
            <div class="balance-value" id="balance">0.0000 usdt</div>
            
            <div class="daily-bonus-container">
                <button class="daily-bonus-btn" id="daily-bonus-btn" onclick="claimDailyBonus()">
                    Claim Daily Bonus (+0.001$)
                </button>
                <div class="timer-text" id="daily-bonus-timer"></div>
            </div>
        </div>
    </div>
    
    <div class="action-buttons">
        <button class="refresh-btn" onclick="location.reload()">
            üîÑ
        </button>

        <div class="chat-btn-container" style="position: static;">
            <a href="chat.html" class="chat-btn">
                <span>üí¨</span> 
            </a>
        </div>
    </div>
</div>



<div class="main-content">
    <div class="rocket-container">
        <div class="cloud cloud1" id="cloud1"></div>
        <div class="cloud cloud2" id="cloud2"></div>
        <div class="cloud cloud3" id="cloud3"></div>
        <img src="rocket.png" alt="Rocket Miner" class="rocket-image" id="rocket"> 
    </div>

    <div class="status-container">
        <div class="status-item">
            <img src="shield.png" alt="Shield" class="status-icon" style="background: none; width: 40px; height: 40px;"> 
            <div class="status-value" id="shield-value">0%</div> 
            <button class="refill-btn" id="shield-btn" onclick="getShield()">Get a shield</button>
        </div>

        <div class="status-item">
            <img src="fuel.png" alt="Fuel" class="status-icon" style="background: none; width: 40px; height: 40px;">
            <div class="status-value" id="fuel-value">0%</div> 
            <button class="refill-btn" id="fuel-btn" onclick="refuel()">Refueling</button>
        </div>
    </div>
    <button class="main-btn" id="launch-btn" onclick="launchMiner()">launch a rocket miner</button>
</div>

<div class="bottom-nav">
    <button class="withdraw-btn" onclick="location.href='withdraw.html'">üí∞ withdraw</button>
    <button class="tasks-btn" onclick="location.href='task.html'">‚úÖ tasks</button>
    <button class="referral-btn" onclick="location.href='referal.html'">referal</button>
    <button class="leaderboard-btn" onclick="location.href='reyting.html'">üèÜ rating</button>
    <button class="action-btn games-btn" onclick="location.href='qush_game.html'">üê¶bird game</button>
</div>


<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://sad.adsgram.ai/js/sad.min.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
// getDatabase, ref, set, get, child, update funksiyalari o'rniga:
import { getDatabase, ref, set, get, child, update, onValue, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

// === FIREBASE KONFIGURATSIYASI ===
const firebaseConfig = {
  apiKey: "AIzaSyDIeG8dVbm0Yk7FR1hPzrBoD7rgDKWAFoY",
  authDomain: "user1111-c84a0.firebaseapp.com",
  databaseURL: "https://user1111-c84a0-default-rtdb.firebaseio.com",
  projectId: "user1111-c84a0",
  storageBucket: "user1111-c84a0.appspot.com",
  messagingSenderId: "901723757936",
  appId: "1:901723757936:web:9da0a1c7ec494f4a0c03b5",
  measurementId: "G-9R8ZQY63B1"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const dbRef = ref(db);

let deviceId = localStorage.getItem("deviceId");
if(!deviceId){
    deviceId = "user_"+Math.random().toString(36).substr(2,9);
    localStorage.setItem("deviceId", deviceId);
}

let balance = 0;
let fuel = 0; 
let shield = 0;
// --- YANGI KUNLIK BONUS O'ZGARUVCHILARI ---
let lastBonusClaimTime = 0; 
const DAILY_BONUS_AMOUNT = 0.001; 
const BONUS_COOLDOWN_MS = 24 * 60 * 60 * 1000; // 24 soat
let bonusTimerInterval = null; 
// ------------------------------------------

const fuelValueEl = document.getElementById("fuel-value");
const shieldValueEl = document.getElementById("shield-value");
const fuelBtn = document.getElementById("fuel-btn");
const shieldBtn = document.getElementById("shield-btn");
const onlineUsersEl = document.getElementById("online-users");
// --- YANGI KUNLIK BONUS ELEMENTLARI ---
const dailyBonusBtn = document.getElementById("daily-bonus-btn");
const dailyBonusTimerEl = document.getElementById("daily-bonus-timer");
// --- YANGI SERVER STATUS ELEMENTI ---
const serverStatusEl = document.getElementById("server-status");
// --------------------------------------

const adBtn = document.getElementById("launch-btn");
const rocketImg = document.getElementById("rocket");
const clouds = [document.getElementById("cloud1"), document.getElementById("cloud2"), document.getElementById("cloud3")]; 
let remainingTime = 0;
const TIMER_SECONDS = 1; // 2 minut
// === O'ZGARTIRILGAN QATOR ===
const MINING_REWARD = 0.0010; // 0.0010 usdt
// =============================
const REWARD_PER_SECOND = MINING_REWARD / TIMER_SECONDS; 
const DECREMENT_RATE = 100 / TIMER_SECONDS; 

let AdController = null; 
let miningInterval = null; 
let referrerId = null; 

// === KUNLIK BONUS FUNKSIYALARI ==================================

// Kunlik bonus tugmasi holatini va taymerni yangilaydi
function updateDailyBonusStatus() {
    const now = Date.now();
    const nextClaimTime = lastBonusClaimTime + BONUS_COOLDOWN_MS;
    const timeLeft = nextClaimTime - now;

    if (timeLeft <= 0) {
        // Bonusni olish mumkin
        dailyBonusBtn.disabled = false;
        dailyBonusBtn.innerText = "Claim Daily Bonus (+$0.001)";
        dailyBonusTimerEl.innerText = "Ready!";
        if (bonusTimerInterval) {
            clearInterval(bonusTimerInterval);
            bonusTimerInterval = null;
        }
    } else {
        // Taymer ishlayapti
        dailyBonusBtn.disabled = true;
        dailyBonusBtn.innerText = "Next Bonus";
        
        const seconds = Math.floor((timeLeft / 1000) % 60);
        const minutes = Math.floor((timeLeft / (1000 * 60)) % 60);
        const hours = Math.floor((timeLeft / (1000 * 60 * 60)) % 24);
        
        const pad = (num) => String(num).padStart(2, '0');
        dailyBonusTimerEl.innerText = `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;

        if (!bonusTimerInterval) {
            // Taymerni har sekundda ishga tushirish
            bonusTimerInterval = setInterval(updateDailyBonusStatus, 1000);
        }
    }
}

// Kunlik bonusni olish funksiyasi
window.claimDailyBonus = function() {
    const now = Date.now();
    // 24 soat o'tganini tekshirish
    if (now >= lastBonusClaimTime + BONUS_COOLDOWN_MS) {
        // Balansni yangilash
        balance += DAILY_BONUS_AMOUNT;
        
        // Oxirgi olingan vaqtni yangilash
        lastBonusClaimTime = now;
        
        // Ekranni va Firebase'ni yangilash
        document.getElementById("balance").innerText = balance.toFixed(4) + " usdt";
        updateDailyBonusStatus();
        
        // Firebase'ga ma'lumotlarni saqlash
        update(ref(db, "users/" + deviceId), { 
            balance: balance.toFixed(4), 
            lastBonusClaimTime: lastBonusClaimTime 
        }).then(() => {
            alert("Daily Bonus claimed successfully! +$0.001 added.");
        }).catch(error => {
            console.error("Kunlik bonusni saqlashda xatolik:", error);
            alert("Bonus saqlandi, ammo Firebase'da xatolik yuz berdi.");
        });
        
    } else {
        alert("Daily Bonus is not ready yet. Please wait.");
    }
};

// =============================================================

// === ADSGRAM/ADSONAR Funksiyalari (Refuel va Shield uchun) ===

function onRefillComplete(resource) {
// (O'ZGARTIRILMAGAN)
    const refillAmount = 50; // Har safar 50% to'ldiriladi
    
    if (resource === 'fuel') {
        // Yoqilg'ini faqat 100% gacha to'ldirish
        fuel = Math.min(100, fuel + refillAmount);
        alert(`Refueling successfully. Current status: ${Math.floor(fuel)}%`);
    } else if (resource === 'shield') {
        // Qalqonni faqat 100% gacha to'ldirish
        shield = Math.min(100, shield + refillAmount);
        alert(`The shield was successfully restored. Current status: ${Math.floor(shield)}%`);
    }
    
    updateStatus();
    // Reklama tugagandan so'ng darhol Firebase'ga yozish
    update(ref(db, "users/" + deviceId), { fuel: fuel, shield: shield });
}

function showRefillAd(resource) {
// (O'ZGARTIRILMAGAN)
    // Agar allaqachon 100% bo'lsa, reklamani ko'rsatmaslik
    if ((resource === 'fuel' && fuel > 99.99) || (resource === 'shield' && shield > 99.99)) {
        alert(resource === 'fuel' ? "The fuel is already 100% full.." : "The shield is already 100% restored.");
        return;
    }

    if (window.Adsgram && AdController) {
        AdController.show().then(() => {
            onRefillComplete(resource);
        }).catch(err => { 
            console.error(err); 
            alert(`The ad could not be loaded or an error occurred. Please click the refresh button above..`);
        });
    } else {
        alert("loading server...");
    }
}

// YANGI: Faqat kirishda avtomatik reklama ko'rsatish uchun funksiya
function showInterstitialAd() {
// (O'ZGARTIRILMAGAN)
    if (window.Adsgram && AdController) {
        // Adsgram to'liq yuklanganini tasdiqlash uchun AdController.show() dan oldin
        // AdController.isReady() funksiyasi mavjud bo'lsa, foydalaniladi.
        // Agar mavjud bo'lmasa, to'g'ridan-to'g'ri ko'rsatishga harakat qilamiz.
        AdController.show().then(() => {
            console.log("Avtomatik to'liq ekranli reklama ko'rsatildi.");
        }).catch(err => { 
            console.error("Avtomatik reklama ko'rsatishda xatolik:", err);
            // Foydalanuvchi interfeysini to'sib qo'ymaslik uchun 'alert' ishlatilmaydi
        });
    }
}


window.refuel = function() {
// (O'ZGARTIRILMAGAN)
    showRefillAd('fuel');
};

window.getShield = function() {
// (O'ZGARTIRILMAGAN)
    showRefillAd('shield');
};
// =============================================================

// === LAUNCH MINER LOGIKASI (TUZATILGAN) ===
window.launchMiner = function() {
// (O'ZGARTIRILMAGAN)
    if (remainingTime > 0) return; 
    
    // 1. Foizlarni tekshirish - Faqat aniq 100% bo'lgandagina ishga tushirilsin
    if (fuel < 99.99 || shield < 99.99) {
        let missing = [];
        if (fuel < 99.99) missing.push("Yoqilg'i (Fuel)");
        if (shield < 99.99) missing.push("Qalqon (Shield)");

        alert(`To launch the rocket, ${missing.join(" and ")} must be 100%. Please complete the ad by watching it..`);
        return;
    }
    
    // 2. Taymerni boshlash
    remainingTime = TIMER_SECONDS;
    startTimer();

    // 3. Ma'lumotlarni saqlash (Taymer boshlanganda)
    let lastLaunchTime = Date.now();
    
    // --- YANGI REYTING MANTIQI QO'SHILDI ---
    // Foydalanuvchining joriy ma'lumotlarini olish
    get(child(dbRef, "users/" + deviceId)).then(snapshot => {
        const userData = snapshot.val();
        // launchCount ni 1 taga oshirish
        const currentLaunchCount = userData ? (userData.launchCount || 0) : 0;
        const newLaunchCount = currentLaunchCount + 1;

        // isMining, lastLaunchTime va launchCount ni bir vaqtda yangilash
        update(ref(db, "users/" + deviceId), { 
            lastLaunchTime: lastLaunchTime, 
            isMining: true,
            launchCount: newLaunchCount // Reyting ballini saqlash
        });
        
        console.log(`Reyting hisoblandi: Launch Count: ${newLaunchCount}`);
    }).catch(error => {
        console.error("Launch Miner/Reyting hisoblashda xatolik:", error);
        // Agar Firebase'dan o'qishda xatolik bo'lsa, hech bo'lmasa asosiy ma'lumotlarni saqlaymiz.
        update(ref(db, "users/" + deviceId), { 
            lastLaunchTime: lastLaunchTime, 
            isMining: true
        });
    });
    // --- YANGI REYTING MANTIQI TUGADI ---
};
// =============================================================

function initializeAdsgram() {
// (O'ZGARTIRILMAGAN)
    // AdsGram mavjudligini tekshirish
    if (window.Adsgram && !AdController) {
        AdController = window.Adsgram.init({blockId:"int-18645"});
        console.log("Adsgram muvaffaqiyatli ishga tushirildi.");
        
        // --- YANGI: ADSGRAM ISHGA TUSHGANDAN KEYIN 50s KUTISH MANTIQI ---
        setTimeout(() => {
            showInterstitialAd();
        }, 50000); 
        // --- YANGI MANTIQ TUGADI ---
        
    } else {
        // Agar birinchi urinishda ishga tushmasa, 1 soniyadan keyin qayta urinib ko'rish
        if (!AdController) {
             console.log("Adsgram yuklanmoqda...");
             setTimeout(initializeAdsgram, 1000); 
        }
    }
}

// === YANGI FUNKSIYA: SERVER HOLATINI NAZORAT QILISH ===
function monitorServerStatus() {
    // 1. Firebase ulanish holatini kuzatish
    onValue(ref(db, '.info/connected'), (snapshot) => {
        const isConnectedToFirebase = snapshot.val();
        
        // Agar internet yo'q bo'lsa (navigator holati) - eng ustun
        if (!navigator.onLine) {
            serverStatusEl.innerText = "No server";
            serverStatusEl.style.color = "#ff4444"; // Qizil
        } 
        // Agar internet bor bo'lsa, lekin Firebase ulanmagan bo'lsa (yoki yangilanishni kutayotgan bo'lsa)
        else if (!isConnectedToFirebase) {
            serverStatusEl.innerText = "Connecting...";
            serverStatusEl.style.color = "#ffcc00"; // Sariq
        } 
        // Agar internet bor va Firebase ham ulangan bo'lsa
        else {
            serverStatusEl.innerText = "Server is active";
            serverStatusEl.style.color = "#00ff88"; // Yashil
        }
    });

    // 2. Browserning onlayn/oofflayn holatini kuzatish (qayta ulanishga majburlash uchun)
    window.addEventListener('online', () => {
        // Online bo'lganda darhol Firebase holatini tekshirish uchun trigger
        if (!navigator.onLine && serverStatusEl.innerText !== "Server is active") {
             serverStatusEl.innerText = "Connecting...";
             serverStatusEl.style.color = "#ffcc00"; // Sariq
        }
    });

    window.addEventListener('offline', () => {
        serverStatusEl.innerText = "No server";
        serverStatusEl.style.color = "#ff4444"; // Qizil
    });
}
// =============================================================


// --- YANGI FUNKSIYA: ONLAYN FOYDALANUVCHILARNI YANGILASH ---
function updateOnlineUsers() {
// (O'ZGARTIRILMAGAN)
    // 1. Foydalanuvchining oxirgi ko'rinish vaqtini yangilash
    // Bu kod foydalanuvchi ilovani ishlatayotganini ko'rsatadi
    update(ref(db, "users/" + deviceId), { 
        last_online: serverTimestamp() 
    });

    // 2. Online foydalanuvchilar sonini hisoblash uchun barcha foydalanuvchilarni tinglash
    // (Lekin bu juda ko'p ma'lumotni o'qishga olib kelishi mumkin.
    // Optimal yechim: alohida 'presence' tugunini ishlatish.)
    
    // Yengilroq usul: Har 2 sekundda barcha foydalanuvchilar orasidan oxirgi 10 sekundda 
    // faol bo'lganlarni hisoblash. Bu faqat test uchun to'g'ri.
    const onlineThreshold = Date.now() - 10000; // Oxirgi 10 sekund
    
    get(child(dbRef, "users")).then(snapshot => {
        let onlineCount = 0;
        if (snapshot.exists()) {
            snapshot.forEach(childSnapshot => {
                const user = childSnapshot.val();
                if (user.last_online && user.last_online > onlineThreshold) {
                    onlineCount++;
                }
            });
        }
        
        // Agar onlineCount joriy foydalanuvchidan kam bo'lsa (bu o'zini o'zi onlayn deb hisoblash uchun),
        // minimal 1 ni ta'minlaymiz, lekin ko'rsatishda haqiqiy sonni ishlatamiz.
        onlineUsersEl.innerText = onlineCount;
        
    }).catch(error => {
        console.error("Online foydalanuvchilarni hisoblashda xatolik:", error);
        // Xatolik yuz berganda 0 yoki '?' ko'rsatish o'rniga, avvalgi qiymatni saqlab qolamiz.
    });
}
// -----------------------------------------------------------

// Ilovani ishga tushirish (Firebase'dan ma'lumotlarni yuklash va AdsGramni initsializatsiya qilish)
function initApp() {
    // 1. Adsgramni ishga tushirishga urinish
    // Bu funksiya ichida endi 2 soniyadan keyin reklama chiqish mantiqi bor.
    initializeAdsgram();
    
    // --- YANGI MANTIQ: SERVER HOLATINI NAZORAT QILISHNI ISHGA TUSHIRISH ---
    monitorServerStatus();
    // ---------------------------------------------------------------------
    
    // --- YANGI MANTIQ: ONLAYN ODAMLAR TAYMERINI ISHGA TUSHIRISH (HAR 2 SEKUND) ---
    updateOnlineUsers(); // Birinchi marta darhol yangilash
    setInterval(updateOnlineUsers, 2000); // Har 2 sekundda yangilash
    // ---------------------------------------------------------------------------
    
    // REFERRAL MANTIQI: Telegram TWA dan start_param ni olish va uni global qilish
    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {
        const startParam = window.Telegram.WebApp.initDataUnsafe.start_param;
        if (startParam && startParam !== deviceId) {
            referrerId = startParam; 
            console.log("Referrer ID topildi:", referrerId);
        }
    }

    // 2. Firebase'dan ma'lumotlarni yuklash va davom ettirish mantiqi
    get(child(dbRef, "users/"+deviceId)).then(snapshot=>{
        if(snapshot.exists()){
            const data = snapshot.val();
            
            // FOIZLAR VA BALANSNI YUKLASH
            
            // === TUZATILGAN QATOR: Balansni yuklashda uni Raqamga (Number) aylantirish
            if(data.balance !== undefined) {
                 // Agar Firebase'da string sifatida saqlangan bo'lsa ham, uni raqamga aylantiramiz
                 balance = parseFloat(data.balance) || 0; 
            }
            // ===================================================================
            
            if(data.fuel !== undefined) fuel = data.fuel;
            if(data.shield !== undefined) shield = data.shield;

            // === YANGI QISM: KUNLIK BONUS VAQTINI YUKLASH ===
            if(data.lastBonusClaimTime !== undefined) {
                 lastBonusClaimTime = data.lastBonusClaimTime;
            }
            updateDailyBonusStatus(); // Kunlik bonus taymerini ishga tushirish
            // ===============================================
            
            // Agar foydalanuvchining referrerId ma'lumoti mavjud bo'lsa, uni ham saqlash
            // Faqat bir marta o'rnatish uchun: agar data.referrerId mavjud bo'lmasa va URL'dan olingan bo'lsa
            if(!data.referrerId && referrerId) {
                // Yangi topilgan referrerId'ni Firebase'ga saqlash
                update(ref(db, "users/" + deviceId), { referrerId: referrerId });
            } else if (data.referrerId) {
                 // Agar Firebase'da mavjud bo'lsa, uni ishlatish
                 referrerId = data.referrerId;
            }
            
            // === O'ZGARTIRILGAN QATOR: Valyutani usdt qilish ===
            document.getElementById("balance").innerText = balance.toFixed(4)+" usdt";
            // =============================
            updateStatus();
            
            // Mining jarayonini davom ettirish yoki tugatish mantiqi
            if(data.isMining && data.lastLaunchTime){
                const now = Date.now();
                const timeSinceLastLaunch = Math.floor((now - data.lastLaunchTime) / 1000); // Sekunddagi farq
                
                // Ilovaga kirguncha o'tgan haqiqiy mining vaqti:
                // Resurslar tugashini hisobga olgan holda maksimal vaqt.
                // Qalqon va Yoqilg'i qanchada tugashini sekundda hisoblash
                const maxDurationByFuel = fuel / DECREMENT_RATE;
                const maxDurationByShield = shield / DECREMENT_RATE;
                
                // O'tgan samarali mining vaqti
                // O'tgan vaqt, Yoqilg'i tugash vaqti va Qalqon tugash vaqtining eng kichigini olish
                const effectiveMiningTime = Math.min(timeSinceLastLaunch, maxDurationByFuel, maxDurationByShield);
                
                // Balans va foizlarni hisoblash
                if (effectiveMiningTime > 0) {
                    const earnedReward = effectiveMiningTime * REWARD_PER_SECOND;
                    balance += earnedReward;
                    
                    const decrementAmount = effectiveMiningTime * DECREMENT_RATE;
                    fuel = Math.max(0, fuel - decrementAmount);
                    shield = Math.max(0, shield - decrementAmount);

                    // YANGI MANTIQ QO'SHILDI: REFERRAL BONUSINI ASOSIY FOYDALANUVCHIGA HAM HISOBLASH
                    if (referrerId) {
                         // 1% ga ko'paytirilgan miqdor (0.02 o'rniga 0.01)
                         const referralPercent = 0.01; 
                         const totalReferrerBonus = effectiveMiningTime * REWARD_PER_SECOND * referralPercent; 
                         
                         // REFERRER balansini yangilash
                         get(child(dbRef, "users/" + referrerId)).then(refSnapshot => {
                             if (refSnapshot.exists()) {
                                 const refData = refSnapshot.val();
                                 // Referral bonusini o'ziga xos maydonga qo'shish
                                 const currentRefBonus = parseFloat(refData.referral_bonus) || 0;
                                 const newRefBonus = currentRefBonus + totalReferrerBonus;
                                 
                                 // REFERER BALANSINI O'ZGARTIRMASDAN, FAQAT REFERRAL BONUSINI YANGILASH
                                 update(ref(db, "users/" + referrerId), { 
                                     referral_bonus: newRefBonus.toFixed(4) // 4 xonali aniqlikda saqlash
                                 });
                                 console.log(`Referrer (${referrerId}) uchun ${totalReferrerBonus.toFixed(4)} mining bonusi hisoblandi.`);
                             }
                         }).catch(error => {
                             console.error("Referrer bonusini yangilashda xatolik:", error);
                         });
                    }
                    
                }
                
                // Qolgan vaqtni resurslarning eng past foiziga qarab hisoblash
                // RemainingTime ni o'tgan vaqtdan keyingi holatiga qarab hisoblash
                const lowestResourcePercent = Math.min(fuel, shield);
                remainingTime = Math.max(0, Math.floor(lowestResourcePercent / DECREMENT_RATE)); 
                
                // Agar resurslar tugagan bo'lsa
                if (remainingTime <= 0) {
                    // Miningni to'xtatish va Firebase'ga yakuniy holatni yozish
                    fuel = 0;
                    shield = 0;
                    
                    // === O'ZGARTIRILGAN QATOR: Balansni 4 xonali aniqlikda usdt qilib saqlash ===
                    document.getElementById("balance").innerText = balance.toFixed(4)+" usdt";
                    // =============================
                    updateStatus();
                    
                    // YANGI MANTIQ: lastLaunchTime ni ham yangilash - bu juda muhim!
                    update(ref(db, "users/" + deviceId), { 
                        balance: balance.toFixed(4), // Balansni string sifatida saqlash
                        fuel: 0, 
                        shield: 0, 
                        isMining: false, 
                        lastLaunchTime: Date.now() // Tugagan vaqtni yozib qo'yish
                    });
                    stopMining();
                    console.log("Resurslar tugadi. Mining to'xtatildi va Firebase yangilandi.");
                } else {
                    // Miningni davom ettirish
                    
                    // Balans va foizlarni yangilash
                    // === O'ZGARTIRILGAN QATOR: Balansni 4 xonali aniqlikda usdt qilish ===
                    document.getElementById("balance").innerText = balance.toFixed(4)+" usdt";
                    // =============================
                    updateStatus();
                    
                    // YANGI MANTIQ: lastLaunchTime ni hozirgi vaqtga yangilash
                    // Bu, keyingi kirishda faqat shu vaqtdan boshlab hisoblashni ta'minlaydi.
                    update(ref(db, "users/" + deviceId), { 
                        balance: balance.toFixed(4), // Balansni string sifatida saqlash
                        fuel: fuel, 
                        shield: shield,
                        isMining: true,
                        lastLaunchTime: now // !!! Eng muhim tuzatish: Kirish vaqtini yozish
                    });
                    
                    startTimer(); // Taymerni qolgan vaqtdan davom ettirish
                    console.log(`Davom etish: Effective Mining Time: ${effectiveMiningTime}s. Qolgan vaqt: ${remainingTime}s.`);
                }
                
            }
        } else {
            // === YANGI FOYDALANUVCHI YARATISH QISMI ===
            const newUser_data = { 
                fuel: 0, 
                shield: 0, 
                balance: "0.0000", 
                isMining: false, 
                lastLaunchTime: Date.now(),
                last_online: serverTimestamp(),
                lastBonusClaimTime: 0,
                referral_bonus: "0.0000" // Yangi foydalanuvchi uchun boshlang'ich bonus maydoni
            };
            
            // Agar bu foydalanuvchi birovning havolasi orqali kirgan bo'lsa
            if (referrerId) {
                 newUser_data.referrerId = referrerId;

                 // --- 1. REFERERGA BONUS YOZISH (0.005 USDT) ---
                 // >>> FOYDALANUVCHI TALABIGA KO'RA, RO'YXATDAN O'TISH BONUSI OLIB TASHLANDI.
                 /*
                 const REFERRAL_SIGNUP_BONUS = 0.005;

                 get(child(dbRef, "users/" + referrerId)).then(refSnapshot => {
                     if (refSnapshot.exists()) {
                         const refData = refSnapshot.val();
                         
                         let currentBalance = parseFloat(refData.balance) || 0;
                         let currentRefBonus = parseFloat(refData.referral_bonus) || 0;
                         
                         let newRefBonus = currentRefBonus + REFERRAL_SIGNUP_BONUS;

                         update(ref(db, "users/" + referrerId), {
                             referral_bonus: newRefBonus.toFixed(4)
                         });
                         console.log(`Referer (${referrerId}) ga ${REFERRAL_SIGNUP_BONUS} ro'yxatdan o'tish bonusi qo'shildi.`);
                     }
                 }).catch(err => console.error("Refererga bonus yozishda xato:", err));
                 */
                 // ------------------------------------------------
            }
            
            // Yangi foydalanuvchini bazaga saqlash
            update(ref(db, "users/" + deviceId), newUser_data);
            
            // Ekranni yangilash
            document.getElementById("balance").innerText = balance.toFixed(4)+" usdt";
            updateStatus();
            updateDailyBonusStatus(); 
        }
    }).catch(error => {
        console.error("Firebase'dan ma'lumotlarni yuklashda xatolik:", error);
    });
}

// Sahifa to'liq yuklanganda ilovani ishga tushirish
window.onload = initApp;


// === FOIZLARNI VA TUGMALARNI YANGILASH FUNKSIYASI (O'ZGARTIRILMADI) ===
function updateStatus() {
// (O'ZGARTIRILMAGAN)
    // Faqat butun sonni ko'rsatish
    fuelValueEl.innerText = `${Math.floor(fuel)}%`;
    shieldValueEl.innerText = `${Math.floor(shield)}%`;
    
    // Tugmalarni yashirish/ko'rsatish mantig'i: Faqat 100% dan past bo'lsa ko'rinadi
    // 99.99% dan past bo'lsa to'ldirish tugmasini ko'rsatish.
    
    if (fuel > 99.99) {
        fuelBtn.classList.add("hidden");
    } else {
        fuelBtn.classList.remove("hidden");
    }

    if (shield > 99.99) {
        shieldBtn.classList.add("hidden");
    } else {
        shieldBtn.classList.remove("hidden");
    }
}
// =======================================================

// === ANIMATSIYA VA TAYMER KODI ===
// (Bu kod sizning original kodingizdan olingan)

function toggleCloudVisibility(shouldShow) {
// (O'ZGARTIRILMAGAN)
    clouds.forEach(cloud => {
        cloud.style.display = shouldShow ? 'block' : 'none';
    });
}

function toggleRocketAnimation(shouldAnimate) {
// (O'ZGARTIRILMAGAN)
    if (shouldAnimate) {
        rocketImg.classList.add('animating');
        toggleCloudVisibility(true);
    } else {
        rocketImg.classList.remove('animating');
        toggleCloudVisibility(false);
    }
}

function stopMining() {
// (O'ZGARTIRILMAGAN)
    clearInterval(miningInterval);
    miningInterval = null;
    toggleRocketAnimation(false);
    adBtn.innerText = "launch a rocket miner";
    remainingTime = 0; 
}

function updateMiningStatus() {
// (O'ZGARTIRILMAGAN)
    // Har bir tsiklda tekshirish, shuningdek, Firebase'ga yangilanishni yuborishdan oldin ham
    if (remainingTime <= 0 || fuel <= 0 || shield <= 0) {
        // Yangilanishda firebasedagi isMining = false ga o'rnatiladi
        stopMining(); 
        
        // YANGI MANTIQ: Mining to'xtaganidan keyin yakuniy holatni Firebase'ga saqlash
        update(ref(db, "users/" + deviceId), { 
            isMining: false, 
            fuel: Math.max(0, fuel), 
            shield: Math.max(0, shield),
            balance: balance.toFixed(4), // Pulni 4 xonali aniqlikda saqlash (string)
            lastLaunchTime: Date.now() // Tugagan vaqtni yozish
        });
        return;
    }

    // 1. Balansni hisoblash va yangilash
    balance += REWARD_PER_SECOND;
    
    // --- REFERRAL BONUSINI SEKUNDMA-SEKUND HISBLASH ---
    if (referrerId) {
        const referralPercent = 0.01; // 1% ga o'zgartirildi
        const currentReferrerBonus = REWARD_PER_SECOND * referralPercent;
        
        // Bu joyda har sekundda referer balansini yangilash tavsiya etilmaydi.
        // Yuqoridagi `initApp` dagi kabi, faqat sekin-asta yangilash mantiqini qoldirish to'g'ri.
        // Hozircha, faqat o'z hisobimizni yangilaymiz.
    }
    // ----------------------------------------------------
    
    // === O'ZGARTIRILGAN QATOR: Balansni 4 xonali aniqlikda usdt qilish ===
    document.getElementById("balance").innerText = balance.toFixed(4)+" usdt";
    // =============================
    
    // 2. Foizlarni kamaytirish
    fuel -= DECREMENT_RATE;
    shield -= DECREMENT_RATE;
    
    // 3. Taymerni kamaytirish
    remainingTime--;
    
    // 4. Ekranni yangilash
    updateStatus();

    // 5. Tugmani vaqtni ko'rsatishga yangilash
    const minutes = Math.floor(remainingTime / 60);
    const seconds = remainingTime % 60;
    const pad = (num) => String(num).padStart(2, '0');
    adBtn.innerText = `Mining: ${pad(minutes)}:${pad(seconds)}`;

    // YANGI MANTIQ: Har 10 ta yangilanishda (10 sekundda) Firebase'ga yozish
    if (remainingTime % 10 === 0) {
        // Shuningdek, 10 sekundda bir marta referer bonusini ham yozamiz
        if (referrerId) {
             const referralPercent = 0.001; // 1% ga o'zgartirildi
             // 10 sekund uchun bonus: 10 * REWARD_PER_SECOND * 0.01
             const bonusFor10Seconds = 10 * REWARD_PER_SECOND * referralPercent;
             
             get(child(dbRef, "users/" + referrerId)).then(refSnapshot => {
                 if (refSnapshot.exists()) {
                     const refData = refSnapshot.val();
                     const currentRefBonus = parseFloat(refData.referral_bonus) || 0;
                     const newRefBonus = currentRefBonus + bonusFor10Seconds;
                     
                     update(ref(db, "users/" + referrerId), { 
                         referral_bonus: newRefBonus.toFixed(4)
                     });
                     console.log(`Referrer (${referrerId}) uchun ${bonusFor10Seconds.toFixed(4)} bonusi 10s da yangilandi.`);
                 }
             }).catch(error => {
                 console.error("Referrer bonusini yozishda xatolik:", error);
             });
        }
        
        // Joriy foydalanuvchi ma'lumotlarini saqlash
        update(ref(db, "users/" + deviceId), { 
            fuel: fuel, 
            shield: shield,
            balance: balance.toFixed(4), // Balansni string sifatida saqlash
            //lastLaunchTime ni yangilamaslik (bu faqat start yoki stop da kerak)
        });
        console.log(`Firebase yangilandi: qolgan vaqt: ${remainingTime}`);
    }
}

function startTimer() {
// (O'ZGARTIRILMAGAN)
    if (miningInterval) clearInterval(miningInterval);
    
    toggleRocketAnimation(true);
    updateMiningStatus(); // Birinchi marta darhol yangilash

    // Har bir sekundda yangilash
    miningInterval = setInterval(() => {
        updateMiningStatus();
    }, 1000);
}

// =======================================================


</script>


</body>
</html>